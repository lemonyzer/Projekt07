MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ; **********************************************************
                      00002 ; * projekt_beta_1_9_1.asm - Playstation Controller an PIC16F84A *
                      00003 ; **********************************************************
                      00004 ;
                      00005 ;       Der PIC soll mit einem PS-Controller kommunizieren
                      00006 ;       und erkennen welche Tasten auf dem Controller gedrückt wurden.
                      00007 ;
                      00008 ;       Wenn er weiß was gedrückt wurde, schaltet er die zu den
                      00009 ;       entsprechenden Tasten gehörenden LED's ein bzw. aus.
                      00010 ;       
                      00011 ;       -> Verwendeter Baustein zur anzeige:    MAX 7219
                      00012 ;
                      00013 ;       Optional:
                      00014 ;                       Kommunikation mit dem PC (RS232)
                      00015 ;                       um einen PS-PC Konverter zu ermöglichen
                      00016 ;
                      00017 ; #############################################################################
                      00018 ;
                      00019 ;       D: Digitaler Controller (keine Joysticks)
                      00020 ;       A: Analoger Controller (2 Joysticks)
                      00021 ;
                      00022 ;RxByte Type    Taste   Hex     Binär
                      00023 ;-------------------------------------------    
                      00024 ;1      D/A     Left    0xFE    11111110
                      00025 ;1      D/A     Down    0xFD    11111101
                      00026 ;1      D/A     Right   0xFB    11111011
                      00027 ;1      D/A     Up      0xF7    11110111
                      00028 ;1      D/A     Start   0xEF    11101111
                      00029 ;1      A       Joy-R   0xDF    11011111        ---- Nur Analoger Controller
                      00030 ;1      A       Joy-L   0xBF    10111111        ---- Nur Analoger Controller
                      00031 ;1      D/A     Select  0x7F    01111111
                      00032 ;-------------------------------------------
                      00033 ;2      D/A     []      0xFE    11111110
                      00034 ;2      D/A     X       0xFD    11111101
                      00035 ;2      D/A     O       0xFB    11111011
                      00036 ;2      D/A     /_\     0xF7    11110111
                      00037 ;2      D/A     R1      0xEF    11101111        
                      00038 ;2      D/A     L1      0xDF    11011111
                      00039 ;2      D/A     R2      0xBF    10111111
                      00040 ;2      D/A     L2      0x7F    01111111
                      00041 ;-------------------------------------------
                      00042 ;  Mehrere Buttons werden UND Verknüpft...
                      00043 ;-------------------------------------------
                      00044 ;       A       Joy-R-X 
                      00045 ;       A       Joy-R-X 
                      00046 ;       A       Joy-R-X 
                      00047 ;       A       Joy-R-X 
                      00048 ;       A       Joy-R-X 
                      00049 ;       A       Joy-R-X 
                      00050 ;       A       Joy-R-X 
                      00051 ;       A       Joy-R-X 
                      00052 ;       -----------------------------------
                      00053 ;       A       Joy-R-Y 
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00054 ;       A       Joy-R-Y 
                      00055 ;       A       Joy-R-Y
                      00056 ;       A       Joy-R-Y 
                      00057 ;       A       Joy-R-Y 
                      00058 ;       A       Joy-R-Y 
                      00059 ;       A       Joy-R-Y 
                      00060 ;       A       Joy-R-Y 
                      00061 ;       -----------------------------------
                      00062 ;       A       Joy-L-X 
                      00063 ;       A       Joy-L-X 
                      00064 ;       A       Joy-L-X 
                      00065 ;       A       Joy-L-X 
                      00066 ;       A       Joy-L-X 
                      00067 ;       A       Joy-L-X 
                      00068 ;       A       Joy-L-X 
                      00069 ;       A       Joy-L-X 
                      00070 ;       -----------------------------------
                      00071 ;       A       Joy-L-Y 
                      00072 ;       A       Joy-L-Y 
                      00073 ;       A       Joy-L-Y 
                      00074 ;       A       Joy-L-Y 
                      00075 ;       A       Joy-L-Y 
                      00076 ;       A       Joy-L-Y 
                      00077 ;       A       Joy-L-Y 
                      00078 ;       A       Joy-L-Y 
                      00079 ;       -----------------------------------
                      00080 ;
                      00081 ;
                      00082 ; **************************************************************
                      00083 ; *                     Changelog beta_1_4              *
                      00084 ; **************************************************************
                      00085 ;       MAX-7219        Kommunikation
                      00086 ;               Initialisierung und Anzeigesteuerung
                      00087 ;               via "Spagetti-Code" & dyn. Tabelle
                      00088 ; **************************************************************
                      00089 ; *                     Changelog beta_1_3              *
                      00090 ; **************************************************************
                      00091 ;       einfache Anzeigeroutine
                      00092 ;       (nur ein Register wird angezeigt)
                      00093 ; **************************************************************
                      00094 ; *                     Changelog beta_1_2              *
                      00095 ; **************************************************************
                      00096 ;       *ERROR*
                      00097 ;       kleine BUGFIXES der Anzeigeroutine mit dyn. Tabelle
                      00098 ;       *ERROR*
                      00099 ; **************************************************************
                      00100 ; *                     Changelog beta_1_1              *
                      00101 ; **************************************************************
                      00102 ;       *ERROR*
                      00103 ;       Anzeigeroutine der einzelnen Register in einem
                      00104 ;       Unterprogramm mit dynamischer Tabelle
                      00105 ;       *ERROR*
                      00106 ; **************************************************************
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00107 ; *                     Changelog beta_1_0              *
                      00108 ; **************************************************************
                      00109 ;       sXXXXX  Register Verarbeitung geändert
                      00110 ;       zaehler Register Verarbeitung geändert
                      00111 ;
                      00112 ;       main    programmpositions LED-Anzeige geändert
                      00113 ; **************************************************************
                      00114 ; *                     Changelog 0_7_5                 *
                      00115 ; **************************************************************
                      00116 ;       Warteschleifen geändert:
                      00117 ;
                      00118 ;               UP_wait_25us <- hinzugefügt     CLOCK
                      00119 ;               UP_wait_50us <- hinzugefügt     ATT
                      00120 ;
                      00121 ; **************************************************************
                      00122 ; *                     Changelog 0_7_4                 *
                      00123 ; **************************************************************
                      00124 ;       Empfangsabfrage zurück auf 0_7_2
                      00125 ;       Warteschleifen geändert:
                      00126 ;
                      00127 ;               UP_wait_5us <- hinzugefügt              CLOCK
                      00128 ;               UP_wait_20us <- hinzugefügt     ATT
                      00129 ;
                      00130 ;               UP_wait_4us <- durch UP_wait_5us ersetzt
                      00131 ;               UP_wait_100us <- gelöscht
                      00132 ; **************************************************************
                      00133 ; *                     Changelog 0_7_3                 *
                      00134 ; **************************************************************
                      00135 ;       Empfangsabfrage geändert...
                      00136 ; **************************************************************
                      00137 ; *                     Changelog 0_7_2                 *
                      00138 ; **************************************************************
                      00139 ;
                      00140 ;       UP_wait_100us hinzugefügt (ausgetauscht mit UP_wait_4us)
                      00141 ;
                      00142 ;       
                      00143 ; **************************************************************
                      00144 ; *                     Changelog 0_7_1                 *
                      00145 ; **************************************************************
                      00146 ;
                      00147 ;       UP_wait_05s hinzugefügt
                      00148 ;
                      00149 ;       Anzeigeroutine folgender Register hinzugefügt:
                      00150 ;        - gSTATUS,gLEFT,gRIGHT,gRJoyX,gRJoyY,gLJoyX,gLJoyY
                      00151 ;
                      00152 ;       kleine Bugfixes
                      00153 ;
                      00154 ; **************************************************************
                      00155 ; *                     Changelog 0_7                   *
                      00156 ; **************************************************************
                      00157 ;
                      00158 ;       KOMPLETT NEUE Sende- & Empfangsroutine
                      00159 ;
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00160 
                      00161 
                      00162 ;***************************************************************************
                      00163 ;* Bestimmung des Prozessortyps für den Assembler und das Programmiergerät *
                      00164 ;***************************************************************************
                      00165 
                      00166                 LIST p=16F84A
                      00167 
                      00168 
                      00169 ;*******************************************************************
                      00170 ;* Includedatei für den 16F84A einbinden (vordef. Reg. und Konst.) *
                      00171 ;*******************************************************************
                      00172 
                      00173                 #include <p16f84A.INC>
                      00001         LIST
                      00002 ; P16F84A.INC  Standard Header File, Version 2.00    Microchip Technology, Inc.
                      00134         LIST
                      00174 
                      00175 ; Diese Datei enthält Vordefinitionen für wichtige Register und Konstanten.
                      00176 ; (Z.B. gibt es die Konstante PORTB mit der sich ohne Angabe der
                      00177 ; absoluten Adresse H'0006' der Port B des Prozessors ansprechen lässt)
                      00178 
                      00179 
                      00180 ;*********************************************************
                      00181 ;* Konfigurationseinstellungen für IC-Prog vordefinieren *
                      00182 ;*********************************************************
                      00183 
2007   3FF2           00184                 __CONFIG _PWRTE_ON & _CP_OFF & _HS_OSC & _WDT_OFF
                      00185 
                      00186 ; Hier werden verschiedene Prozessoreigenschaften festgelegt:
                      00187 ; _PWRTE_ON schaltet den Power Up Timer ein, d.h. der Prozessor wartet nach
                      00188 ;           dem Einschalten ca. 70ms mit dem Programmstart, um sicher zu sein,
                      00189 ;           dass alle angeschlossene Peripherie bereit ist.
                      00190 ; _CP_OFF schaltet die Code-Protection des Prozesors aus. Damit ist das im Prozessor
                      00191 ;        befindliche Programm jederzeit auslesbar und überschreibbar.
                      00192 ; _HS_OSC spezifiziert einen Quarzoszillator (Highspeed) als Zeitbasis für den Prozessor.
                      00193 ; _WDT_OFF schaltet den Watchdog-Timer des Prozesors aus.
                      00194 
                      00195 
                      00196 ;***********************************
                      00197 ;* Register / Variablen  festlegen *
                      00198 ;***********************************
                      00199 ; hier werden Adressen von Registern / Variablen festgelegt. Diese werden beginnend
                      00200 ; mit der Adresse H'20' aufsteigend vergeben.
                      00201 
                      00202 
                      00203         CBLOCK  H'20'
                      00204         
  00000020            00205                 zaehler         ;Übertragungszähler (Bits)
                      00206 
  00000021            00207                 sSTART          ;START-Befehl     (00000001)
                      00208 
  00000022            00209                 sTYPE           ;GET TYPE-Befehl  (01000010)
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000023            00210                 gTYPE           ;Empfangene Daten nach dem GET TYPE Befehl
                      00211 
  00000024            00212                 gSTATUS         ;Status des Controllers (0x5A wenn bereit)
  00000025            00213                 rSTATUS         ;Register um gSTATUS mit 0x5A zu vergleichen
                      00214 
  00000026            00215                 gLEFT           ;Status der Buttons: 
                      00216                                 ;<- | \/ | -> | /\ | Start | JL | JR | Select
                      00217                 
  00000027            00218                 gRIGHT          ;Status der Buttons:
                      00219                                 ;[] | X | O | /_\ | R1 | L1 | R2 | L2
                      00220                                 
  00000028            00221                 gRJoyX          ;X Position des rechten Joysticks
  00000029            00222                 gRJoyY          ;Y Position des rechten Joysticks
                      00223                 
  0000002A            00224                 gLJoyX          ;X Position des linken Joysticks
  0000002B            00225                 gLJoyY          ;X Position des linken Joysticks
                      00226                 
  0000002C            00227                 sMAX            ;Register das zur Kommunikation zwischen PIC
                      00228                                 ;und MAX-7219 dient
                      00229                                 
  0000002D            00230                 sMAX_B1         ;Byte1
  0000002E            00231                 sMAX_B2         ;Byte2 
                      00232                 
                      00233                 ;wait_20us      ;Wartezeit nach dem a_ATT auf 0 geht
  0000002F            00234                 wait_50us       ;Wartezeit nach dem a_ATT auf 0 geht    ;NEW
                      00235                 
                      00236                 ;wait_5us               ;Wartezeit zwischen CLOCK LOW und HIGH
  00000030            00237                 wait_25us       ;Wartezeit zwischen CLOCK LOW und HIGH  ;NEW
                      00238                 
  00000031            00239                 wait_05s
  00000032            00240                 wait_05s_1
  00000033            00241                 wait_05s_2
                      00242         
                      00243         ENDC
                      00244 
                      00245 
                      00246 ;***************************************************************
                      00247 ;               * Konstanten festlegen * 
                      00248 ;***************************************************************
                      00249 
                      00250 ;*****************************************
                      00251 ;       * Konstanten des MAX-7219 * 
                      00252 ;*****************************************
                      00253 
                      00254 ;zur Initialisierung:
                      00255 
                      00256 ;MAX Digit Kodierungs
  00000009            00257 kMODUS_adr      EQU     B'00001001' ; 0x09 Modusbefehlsadresse
  00000000            00258 m_MODUS         EQU     B'00000000' ; 0x00 MAX Digit Kodierungsmodus            ->keine Kodierung<-
                      00259 
  00000009            00260 kD_MODUS_adr    EQU     B'00001001' ; 0x09 Digit Kodierungsmodus Adresse
  00000000            00261 m_D_MODUS       EQU     B'00000000' ; 0x00 MAX Digit Kodierungsmodus            ->keine Kodierung<-
                      00262 
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00263 ;MAX Digit Helligkeit
  0000000A            00264 kHELLIGKEIT_adr EQU     B'00001010' ; 0x0A MAX Helligkeitssteuerung Adresse
  0000000F            00265 m_HELLIGKEIT    EQU     B'00001111' ; 0x15 MAX Helligkeitssteuerung             ->Digit 31 / 32 (max ON)
                            <-
                      00266 
                      00267 ;MAX Digit Anzahl
  0000000B            00268 kDIGITS_adr     EQU     B'00001011' ; 0x0B Digitsanzahl Adresse
  00000001            00269 m_DIGITS                EQU     B'00000001' ; 0x01 Anzahl der aktivierten Digits        ->Digit 0 und 1<
                            -
                      00270 
                      00271 ;MAX Shutdown
  0000000C            00272 kSTART_adr      EQU     B'00001100' ; 0x0C Startbefehlsadresse
  00000001            00273 m_START         EQU     B'00000001' ; 0x01 MAX Shutdownbefehl           ->Normal Operation<-
                      00274 
  0000000C            00275 kSHUTDOWN_adr   EQU     B'00001100' ; 0x0C SHUTDOWN Adresse
  00000001            00276 m_SHUTDOWN      EQU     B'00000001' ; 0x01 MAX Shutdownbefehl           ->Normal Operation<-
                      00277 
                      00278 ;MAX Test
  0000000F            00279 kTEST_adr       EQU     B'00001111' ; 0x0F Testbefehlsadresse
  00000000            00280 m_TEST          EQU     B'00000000' ; 0x00 MAX Testmodus                        ->KEIN TESTMODUS<-
                      00281 
                      00282 ;zur Digitauswahl
                      00283 ;Könnte auch mit einem Zaehler gemacht werden, aber ich möchte auswählen
                      00284 ;wo welches Register angezeigt werden soll
                      00285 ;später mach ich es mit TABELLE!!!!!!!!!!!!!
                      00286 
  00000001            00287 kTYPE_adr       EQU     B'00000001' ; Type - Digit-Adresse
  00000002            00288 kSTATUS_adr     EQU     B'00000010' ; Status - Digit-Adresse
                      00289 
  00000003            00290 kLEFT_adr       EQU     B'00000011' ; LINKS - Digit-Adresse
  00000004            00291 kRIGHT_adr      EQU     B'00000100' ; RECHTS - Digit-Adresse
                      00292 
  00000005            00293 kRJoyX_adr      EQU     B'00000101' ; Joystick rechts x-Achse - Digit-Adresse
  00000006            00294 kRJoyY_adr      EQU     B'00000110' ; Joystick rechts y-Achse - Digit-Adresse
                      00295 
  00000007            00296 kLJoyX_adr      EQU     B'00000111' ; Joystick links x-Achse - Digit-Adresse
  00000008            00297 kLJoyY_adr      EQU     B'00001000' ; Joystick links y-Achse - Digit-Adresse 
                      00298 
                      00299 
                      00300 ; ***********************************************************************
                      00301 ; * Definition von einzelnen Bits in einem Register / in einer Variable *
                      00302 ; ***********************************************************************
                      00303 
                      00304 ;##################### Verbindungen zum Controller ################### 
                      00305 ;##################### ___________________________ ###################
                      00306 #DEFINE e_DATA          PORTA, 0                ; Data          Eingang
                      00307 #DEFINE a_COMMAND       PORTA, 1                ; Command       Ausgang
                      00308 #DEFINE a_CLOCK         PORTA, 2                ; Takt          Ausgang
                      00309 #DEFINE a_ATT           PORTA, 3                ; ATT           Ausgang
                      00310 
                      00311 ;###################### Verbindungen zur Anzeige ##################### 
                      00312 ;###################### ________________________ #####################
                      00313 #DEFINE a1              PORTB, 0                ;               Ausgang
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00314 #DEFINE b1              PORTB, 1                ;               Ausgang
                      00315 #DEFINE c1              PORTB, 2                ;               Ausgang
                      00316 #DEFINE d1              PORTB, 3                ;               Ausgang
                      00317 ;###############################
                      00318 #DEFINE a2              PORTB, 4                ;               Ausgang
                      00319 #DEFINE b2              PORTB, 5                ;               Ausgang
                      00320 #DEFINE c2              PORTB, 6                ;               Ausgang
                      00321 #DEFINE d2              PORTB, 7                ;               Ausgang
                      00322 ;###############################
                      00323 #DEFINE a_MAX_DATA      PORTB, 0                ; MAX-7219-DATA Ausgang
                      00324 #DEFINE a_MAX_CLOCK     PORTB, 1                ; MAX-7219-CLOCK        Ausgang
                      00325 #DEFINE a_MAX_LOAD      PORTB, 2                ; MAX-7219-CLOCK        Ausgang
                      00326 ;#####################################################################
                      00327 #DEFINE bank1           STATUS, RP0
                      00328 ;#####################################################################
                      00329 
                      00330 ;*****************
                      00331 ;* Programmstart *
                      00332 ;*****************
                      00333 
0000                  00334         ORG     H'00'           ; Das Programm wird ab Speicherstelle 0 in den Speicher geschrieben
0000   2801           00335         GOTO    init            ; Springe zur Grundinitialisierung der Ports A und B
                      00336 
                      00337 
                      00338 ;*******************
                      00339 ;* Initialisierung *
                      00340 ;*******************
                      00341 
0001   1683           00342 init    BSF     bank1           ; wechsle zu Registerbank 1 (spezielle Register)
                      00343 
0002   3001           00344         MOVLW   B'00000001'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0003   0085           00345         MOVWF   TRISA           ; RA0 Eingang (RA1 bis RA7 sind Ausgänge)
0004   3000           00346         MOVLW   B'00000000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0005   0086           00347         MOVWF   TRISB           ; RB0 bis RB7 sind Ausgänge
                      00348         
                      00349 ; Die Register TRISA und TRISB legen fest, welche Bits in den jeweiligen Ports Ein- bzw.
                      00350 ; Ausgänge sind. Eine '1' an der entsprechenden Stelle setzt das Bit des Ports als Ein-
                      00351 ; gang eine '0' setzt das Bit als Ausgang.
                      00352         
0006   1283           00353         BCF     bank1           ; wechsle zu Registerbank 0 (normaler Speicherbereich)
                      00354         
0007   0185           00355         CLRF    PORTA           ; Port A löschen
0008   0186           00356         CLRF    PORTB           ; Port B löschen
                      00357 
                      00358 
0009   01A3           00359         CLRF    gTYPE
000A   01A4           00360         CLRF    gSTATUS
000B   01A6           00361         CLRF    gLEFT
000C   01A7           00362         CLRF    gRIGHT
000D   01A8           00363         CLRF    gRJoyX
000E   01A9           00364         CLRF    gRJoyY
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000F   01AA           00365         CLRF    gLJoyX
0010   01AB           00366         CLRF    gLJoyY
                      00367         
                      00368 
0011   01AC           00369         CLRF    sMAX
                      00370         
                      00371         
0012   3008           00372         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
0013   00A0           00373         MOVWF   zaehler         ;empfangen werden sollen
                      00374         
0014   3001           00375         MOVLW   B'00000001'     
0015   00A1           00376         MOVWF   sSTART          ;START-Befehl     (00000001) = H'01'
                      00377         
0016   3042           00378         MOVLW   B'01000010'     
0017   00A2           00379         MOVWF   sTYPE           ;GET-TYPE-Befehl  (01000010) = H'42'
                      00380         
0018   305A           00381         MOVLW   B'01011010'     
0019   00A5           00382         MOVWF   rSTATUS         ;rSTATUS = Status des Controller wenn bereit
                      00383                                 ;0x5A = 1011010
                      00384 ;*****************
                      00385 ;* Hauptprogramm *
                      00386 ;*****************
                      00387 
001A                  00388 main
001A   2139           00389         CALL    UP_wait_50us    ;       
001B   1585           00390         BSF     a_ATT           ; ATT auf HIGH, Controller wird abgewählt
                      00391                                 ; (ignoriert alle Daten)
001C   213E           00392         CALL    UP_wait_25us
001D   1505           00393         BSF     a_CLOCK         ; Clock HIGH
001E   1485           00394         BSF     a_COMMAND       ; Command HIGH
                      00395         
001F   1185           00396         BCF     a_ATT           ; ATT auf LOW das der Controller
                      00397                                 ; die Daten annimmt
                      00398                                         
0020   2139           00399         CALL    UP_wait_50us    ; Warteschlange bis Controller bereit ist
                      00400         
                      00401 ;#########              
                      00402 ;       BSF     a1;;;;;;;;;
0021   202E           00403         CALL    UP_Start                ;Senden:                H'01' Startbefehl
                      00404 ;       BCF     a1;;;;;;;;;
                      00405 ;#########      
                      00406 ;       BSF     b1;;;;;;;;;     
0022   2047           00407         CALL    UP_Get_Type     ;Senden:                H'42' Datenanfrage
                      00408                                 ;------------------------------------
                      00409                                 ;Empfangen:     H'41'=Digital
                      00410                                 ;ODER           H'23'=NegCon
                      00411                                 ;ODER           H'73'=Analogue Red LED
                      00412                                 ;ODER           H'53'=Analogue Green LED
                      00413 ;       BCF     b1;;;;;;;;;
                      00414 ;#########
                      00415 ;       BSF     c1;;;;;;;;;
0023   2070           00416         CALL    UP_Get_Status   ;Empfangen:  H'5A' - Status:READY
                      00417                                 ;------------------------------------
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00418                                 ;Senden:     H'00' - Idle-Modus
                      00419 ;       BCF     c1;;;;;;;;;
                      00420 ;#########
                      00421 ;       BSF     d1;;;;;;;;;
0024   2084           00422         CALL    UP_Get_L_btns   ;Empfangen:  H'xx' - Status der linken Btns
                      00423                                 ;------------------------------------
                      00424                                 ;Senden:     H'00' - Idle-Modus
                      00425 ;       BCF     d1;;;;;;;;;
                      00426 ;#########
                      00427 ;       BSF     a2;;;;;;;;;
0025   2098           00428         CALL    UP_Get_R_btns   ;Empfangen:  H'xx' - Status der rechten Btns
                      00429                                 ;------------------------------------
                      00430                                 ;Senden:     H'00' - Idle-Modus
                      00431 ;       BCF     a2;;;;;;;;;
                      00432 ;#########
                      00433 ;       BSF     b2;;;;;;;;;
0026   20AC           00434         CALL    UP_Get_R_Joy_X  ;Empfangen:  H'xx' - rechtes Joystick, X-Achse
                      00435                                 ;------------------------------------
                      00436                                 ;Senden:     H'00' - Idle-Modus
                      00437 ;       BCF     b2;;;;;;;;;
                      00438 ;#########
                      00439 ;       BSF     c2;;;;;;;;;
0027   20C0           00440         CALL    UP_Get_R_Joy_Y  ;Empfangen:  H'xx' - rechtes Joystick, Y-Achse
                      00441                                 ;------------------------------------
                      00442                                 ;Senden:     H'00' - Idle-Modus
                      00443 ;       BCF     c2;;;;;;;;;
                      00444 ;#########
                      00445 ;       BSF     d2;;;;;;;;;
0028   20D4           00446         CALL    UP_Get_L_Joy_X  ;Empfangen:  H'xx' - linkes Joystick, X-Achse
                      00447                                 ;------------------------------------
                      00448                                 ;Senden:     H'00' - Idle-Modus
                      00449 ;       BCF     d2;;;;;;;;;
                      00450 ;#########
                      00451 ;       BSF     c2;;;;;;;;;
0029   20E8           00452         CALL    UP_Get_L_Joy_Y  ;Empfangen:  H'xx' - linkes Joystick, Y-Achse
                      00453                                 ;------------------------------------
                      00454                                 ;Senden:     H'00' - Idle-Modus
                      00455 ;       BCF     c2;;;;;;;;;
                      00456 ;#########
                      00457 ;       BSF     b2;;;;;;;;;
                      00458 ;       CALL    UP_Show_btns    ;Ausgabe der gXXXX (g=> GET) Register
                      00459 ;       BCF     b2;;;;;;;;;
                      00460 ;#########
                      00461 
                      00462 ;#########
002A   1386           00463          BCF    d2
002B   2100           00464         CALL    UP_MAX          ;Ausgabe 
002C   1786           00465         BSF     d2
                      00466 ;#########       
                      00467          
                      00468 
Warning[203]: Found opcode in column 1. (GOTO)
002D   281A           00469 GOTO    main                    ;Springe wieder an den Anfang zurück   
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00470 
                      00471 ;******************
                      00472 ;* Unterprogramme *
                      00473 ;******************
                      00474 ;###############################################################################
                      00475 ;###############################################################################
002E                  00476 UP_Start        
                      00477         ;H'01' (Bitfolge 00000001) muss im LSB-Verfahren über 
                      00478         ;a_COMMAND gesendet werden.
                      00479         
002E   3001           00480         MOVLW   B'00000001'     
002F   00A1           00481         MOVWF   sSTART          ;START-Befehl     (00000001) = H'01'
                      00482         
0030   3008           00483         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
0031   00A0           00484         MOVWF   zaehler         ;empfangen werden sollen
                      00485         
Message[305]: Using default destination of 1 (file).
0032   0CA1           00486 Start_1 RRF     sSTART          ;verschiebe sSTART nach rechts...
0033   1C03           00487         BTFSS   STATUS,C                ;und prüfe Wertigkeit des rausgeworfenen Bits
0034   283B           00488         GOTO    UP_Bit0         ;(STATUS,C=0)-> Übertrage '0' an Controller...
0035   2841           00489         GOTO    UP_Bit1         ;(STATUS,C=1)-> ansonsten Übertrage '1' 
                      00490 
Message[305]: Using default destination of 1 (file).
0036   03A0           00491 Start_2 DECF    zaehler         ;zaehler -1
0037   08A0           00492         MOVF    zaehler,F       ;zaehler ins Arbeitsregister...
0038   1903           00493         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
0039   0008           00494         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Startbefehl ausgeführt
003A   2832           00495         GOTO    Start_1         ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00496         
003B   1085           00497 UP_Bit0 BCF     a_COMMAND       ;auf 0 setzten
003C   1105           00498         BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
003D   213E           00499         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
003E   1505           00500         BSF     a_CLOCK
003F   213E           00501         CALL    UP_wait_25us
0040   2836           00502         GOTO    Start_2
                      00503         
0041   1485           00504 UP_Bit1 BSF     a_COMMAND       ;auf 1 setzten
0042   1105           00505         BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
0043   213E           00506         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
0044   1505           00507         BSF     a_CLOCK
0045   213E           00508         CALL    UP_wait_25us
0046   2836           00509         GOTO    Start_2
                      00510 ;###############################################################################        
                      00511 ;###############################################################################
0047                  00512 UP_Get_Type     
                      00513         ;H'42' (Bitfolge 01000010) muss im LSB-Verfahren über 
                      00514         ;a_COMMAND gesendet werden.
                      00515         
0047   3042           00516         MOVLW   B'01000010'     
0048   00A2           00517         MOVWF   sTYPE           ;GET-TYPE-Befehl  (01000010) = H'42'
                      00518         
0049   3008           00519         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
004A   00A0           00520         MOVWF   zaehler         ;empfangen werden sollen
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00521         
Message[305]: Using default destination of 1 (file).
004B   0CA2           00522 Type_1  RRF     sTYPE           ;verschiebe sSTART nach rechts...
004C   1C03           00523         BTFSS   STATUS,C                ;und prüfe Wertigkeit des rausgeworfenen Bits
004D   2854           00524         GOTO    UP_Bit0_write_gTYPE     ;(STATUS,C=0)-> Übertrage '0' an Controller...
004E   2862           00525         GOTO    UP_Bit1_write_gTYPE     ;(STATUS,C=1)-> ansonsten Übertrage '1' 
                      00526 
Message[305]: Using default destination of 1 (file).
004F   03A0           00527 Type_2  DECF    zaehler         ;zaehler -1
0050   08A0           00528         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
0051   1903           00529         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
0052   0008           00530         RETURN                  ;(STATUS,Z=1)-> zaehler =0 GET-Type-Befehl ausgeführt
0053   284B           00531         GOTO    Type_1          ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00532 ;###########################################################    
0054                  00533 UP_Bit0_write_gTYPE
0054   1085           00534         BCF     a_COMMAND       ;auf 0 setzten
0055   1105           00535         BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
0056   213E           00536         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
0057   1805           00537         BTFSC   e_DATA          ;e_DATA prüfen
0058   285E           00538         GOTO    sTYPE0_write_1  ;empfangenes Bit in Carry-Flag setzen
0059   2860           00539         GOTO    sTYPE0_write_0  ;empfangenes Bit in Carry-Flag setzen
005A                  00540 sTYPE0_next     
Message[305]: Using default destination of 1 (file).
005A   0DA3           00541         RLF     gTYPE           ;empfangenes Bit in Register hinzufügen
005B   1505           00542         BSF     a_CLOCK
005C   213E           00543         CALL    UP_wait_25us
005D   284F           00544         GOTO    Type_2
                      00545 ;###################################### 
005E                  00546 sTYPE0_write_1
005E   1403           00547         BSF     STATUS,C
005F   285A           00548         GOTO    sTYPE0_next
                      00549 
0060                  00550 sTYPE0_write_0
0060   1003           00551         BCF     STATUS,C
0061   285A           00552         GOTO    sTYPE0_next     
                      00553 ;###########################################################
0062                  00554 UP_Bit1_write_gTYPE
0062   1485           00555         BSF     a_COMMAND       ;auf 1 setzten
0063   1105           00556         BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
0064   213E           00557         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
0065   1805           00558         BTFSC   e_DATA          ;e_DATA prüfen
0066   286C           00559         GOTO    sTYPE1_write_1  ;empfangenes Bit in Carry-Flag setzen
0067   286E           00560         GOTO    sTYPE1_write_0  ;empfangenes Bit in Carry-Flag setzen
0068                  00561 sTYPE1_next     
Message[305]: Using default destination of 1 (file).
0068   0DA3           00562         RLF     gTYPE           ;empfangenes Bit in Register hinzufügen
0069   1505           00563         BSF     a_CLOCK
006A   213E           00564         CALL    UP_wait_25us
006B   284F           00565         GOTO    Type_2
                      00566 ;######################################
006C                  00567 sTYPE1_write_1
006C   1403           00568         BSF     STATUS,C
006D   2868           00569         GOTO    sTYPE1_next
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00570 
006E                  00571 sTYPE1_write_0
006E   1003           00572         BCF     STATUS,C
006F   2868           00573         GOTO    sTYPE1_next
                      00574 ;###############################################################################
                      00575 ;###############################################################################
0070                  00576 UP_Get_Status   
                      00577         ;H'00' (Bitfolge 00000000) muss im LSB-Verfahren über 
                      00578         ;a_COMMAND gesendet werden.
                      00579         ;IDLE-Modus
                      00580         
0070   3008           00581         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
0071   00A0           00582         MOVWF   zaehler         ;empfangen werden sollen
0072   1085           00583         BCF     a_COMMAND       ;auf 0 setzten
                      00584         
0073   1105           00585 Status_1        BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
0074   213E           00586         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
0075   1805           00587         BTFSC   e_DATA          ;e_DATA prüfen
0076   2880           00588         GOTO    gSTATUS_write_1 ;empfangenes Bit in Carry-Flag setzen
0077   2882           00589         GOTO    gSTATUS_write_0 ;empfangenes Bit in Carry-Flag setzen
0078                  00590 Status_2        
Message[305]: Using default destination of 1 (file).
0078   0DA4           00591         RLF     gSTATUS         ;empfangenes Bit in Register hinzufügen
0079   1505           00592         BSF     a_CLOCK
007A   213E           00593         CALL    UP_wait_25us
Message[305]: Using default destination of 1 (file).
007B   03A0           00594         DECF    zaehler         ;zaehler -1
007C   08A0           00595         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
007D   1903           00596         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
007E   0008           00597         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Status empfangen
007F   2873           00598         GOTO    Status_1                ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00599 ;###################################### 
0080                  00600 gSTATUS_write_1
0080   1403           00601         BSF     STATUS,C
0081   2878           00602         GOTO    Status_2
                      00603 
0082                  00604 gSTATUS_write_0
0082   1003           00605         BCF     STATUS,C
0083   2878           00606         GOTO    Status_2
                      00607 ;###############################################################################
                      00608 ;###############################################################################
0084                  00609 UP_Get_L_btns   
                      00610         ;H'00' (Bitfolge 00000000) muss im LSB-Verfahren über 
                      00611         ;a_COMMAND gesendet werden.
                      00612         ;IDLE-Modus
                      00613         
0084   3008           00614         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
0085   00A0           00615         MOVWF   zaehler         ;empfangen werden sollen
0086   1085           00616         BCF     a_COMMAND       ;auf 0 setzten
                      00617         
0087   1105           00618 L_btns_1        BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
0088   213E           00619         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
0089   1805           00620         BTFSC   e_DATA          ;e_DATA prüfen
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008A   2894           00621         GOTO    gLEFT_write_1   ;empfangenes Bit in Carry-Flag setzen
008B   2896           00622         GOTO    gLEFT_write_0   ;empfangenes Bit in Carry-Flag setzen
008C                  00623 L_btns_2        
Message[305]: Using default destination of 1 (file).
008C   0DA6           00624         RLF     gLEFT           ;empfangenes Bit in Register hinzufügen
008D   1505           00625         BSF     a_CLOCK
008E   213E           00626         CALL    UP_wait_25us
Message[305]: Using default destination of 1 (file).
008F   03A0           00627         DECF    zaehler         ;zaehler -1
0090   08A0           00628         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
0091   1903           00629         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
0092   0008           00630         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Status der linken Buttons empfangen
                      00631                                 ;<- | \/ | -> | /\ | Start | JL | JR | Select 
0093   2887           00632         GOTO    L_btns_1                ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00633 ;###################################### 
0094                  00634 gLEFT_write_1
0094   1403           00635         BSF     STATUS,C
0095   288C           00636         GOTO    L_btns_2
                      00637 
0096                  00638 gLEFT_write_0
0096   1003           00639         BCF     STATUS,C
0097   288C           00640         GOTO    L_btns_2
                      00641 ;###############################################################################
                      00642 ;###############################################################################
0098                  00643 UP_Get_R_btns   
                      00644         ;H'00' (Bitfolge 00000000) muss im LSB-Verfahren über 
                      00645         ;a_COMMAND gesendet werden.
                      00646         ;IDLE-Modus
                      00647         
0098   3008           00648         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
0099   00A0           00649         MOVWF   zaehler         ;empfangen werden sollen
009A   1085           00650         BCF     a_COMMAND       ;auf 0 setzten
                      00651         
009B   1105           00652 R_btns_1        BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
009C   213E           00653         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
009D   1805           00654         BTFSC   e_DATA          ;e_DATA prüfen
009E   28A8           00655         GOTO    gRIGHT_write_1  ;empfangenes Bit in Carry-Flag setzen
009F   28AA           00656         GOTO    gRIGHT_write_0  ;empfangenes Bit in Carry-Flag setzen
00A0                  00657 R_btns_2        
Message[305]: Using default destination of 1 (file).
00A0   0DA7           00658         RLF     gRIGHT          ;empfangenes Bit in Register hinzufügen
00A1   1505           00659         BSF     a_CLOCK
00A2   213E           00660         CALL    UP_wait_25us
Message[305]: Using default destination of 1 (file).
00A3   03A0           00661         DECF    zaehler         ;zaehler -1
00A4   08A0           00662         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
00A5   1903           00663         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
00A6   0008           00664         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Status der rechten Buttons empfangen
                      00665                                 ;[] | X | O | /_\ | R1 | L1 | R2 | L2
00A7   289B           00666         GOTO    R_btns_1                ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00667 ;###################################### 
00A8                  00668 gRIGHT_write_1
00A8   1403           00669         BSF     STATUS,C
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A9   28A0           00670         GOTO    R_btns_2
                      00671 
00AA                  00672 gRIGHT_write_0
00AA   1003           00673         BCF     STATUS,C
00AB   28A0           00674         GOTO    R_btns_2
                      00675 ;###############################################################################
                      00676 ;###############################################################################
00AC                  00677 UP_Get_R_Joy_X  
                      00678         ;H'00' (Bitfolge 00000000) muss im LSB-Verfahren über 
                      00679         ;a_COMMAND gesendet werden.
                      00680         ;IDLE-Modus
                      00681         
00AC   3008           00682         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
00AD   00A0           00683         MOVWF   zaehler         ;empfangen werden sollen
00AE   1085           00684         BCF     a_COMMAND       ;auf 0 setzten
                      00685         
00AF   1105           00686 R_JoyX_1        BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
00B0   213E           00687         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
00B1   1805           00688         BTFSC   e_DATA          ;e_DATA prüfen
00B2   28BC           00689         GOTO    gRJoyX_write_1  ;empfangenes Bit in Carry-Flag setzen
00B3   28BE           00690         GOTO    gRJoyX_write_0  ;empfangenes Bit in Carry-Flag setzen
00B4                  00691 R_JoyX_2        
Message[305]: Using default destination of 1 (file).
00B4   0DA8           00692         RLF     gRJoyX          ;empfangenes Bit in Register hinzufügen
00B5   1505           00693         BSF     a_CLOCK
00B6   213E           00694         CALL    UP_wait_25us
Message[305]: Using default destination of 1 (file).
00B7   03A0           00695         DECF    zaehler         ;zaehler -1
00B8   08A0           00696         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
00B9   1903           00697         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
00BA   0008           00698         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Position des rechten Joysticks (x-Achse)
00BB   28AF           00699         GOTO    R_JoyX_1                ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00700 ;###################################### 
00BC                  00701 gRJoyX_write_1
00BC   1403           00702         BSF     STATUS,C
00BD   28B4           00703         GOTO    R_JoyX_2
                      00704 
00BE                  00705 gRJoyX_write_0
00BE   1003           00706         BCF     STATUS,C
00BF   28B4           00707         GOTO    R_JoyX_2
                      00708 ;###############################################################################
                      00709 ;###############################################################################
00C0                  00710 UP_Get_R_Joy_Y  
                      00711         ;H'00' (Bitfolge 00000000) muss im LSB-Verfahren über 
                      00712         ;a_COMMAND gesendet werden.
                      00713         ;IDLE-Modus
                      00714         
00C0   3008           00715         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
00C1   00A0           00716         MOVWF   zaehler         ;empfangen werden sollen
00C2   1085           00717         BCF     a_COMMAND       ;auf 0 setzten
                      00718         
00C3   1105           00719 R_JoyY_1        BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
00C4   213E           00720         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C5   1805           00721         BTFSC   e_DATA          ;e_DATA prüfen
00C6   28D0           00722         GOTO    gRJoyY_write_1  ;empfangenes Bit in Carry-Flag setzen
00C7   28D2           00723         GOTO    gRJoyY_write_0  ;empfangenes Bit in Carry-Flag setzen
00C8                  00724 R_JoyY_2        
Message[305]: Using default destination of 1 (file).
00C8   0DA9           00725         RLF     gRJoyY          ;empfangenes Bit in Register hinzufügen
00C9   1505           00726         BSF     a_CLOCK
00CA   213E           00727         CALL    UP_wait_25us
Message[305]: Using default destination of 1 (file).
00CB   03A0           00728         DECF    zaehler         ;zaehler -1
00CC   08A0           00729         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
00CD   1903           00730         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
00CE   0008           00731         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Position des rechten Joysticks (y-Achse)
00CF   28C3           00732         GOTO    R_JoyY_1                ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00733 ;###################################### 
00D0                  00734 gRJoyY_write_1
00D0   1403           00735         BSF     STATUS,C
00D1   28C8           00736         GOTO    R_JoyY_2
                      00737 
00D2                  00738 gRJoyY_write_0
00D2   1003           00739         BCF     STATUS,C
00D3   28C8           00740         GOTO    R_JoyY_2
                      00741 ;###############################################################################
                      00742 ;###############################################################################
00D4                  00743 UP_Get_L_Joy_X  
                      00744         ;H'00' (Bitfolge 00000000) muss im LSB-Verfahren über 
                      00745         ;a_COMMAND gesendet werden.
                      00746         ;IDLE-Modus
                      00747         
00D4   3008           00748         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
00D5   00A0           00749         MOVWF   zaehler         ;empfangen werden sollen
00D6   1085           00750         BCF     a_COMMAND       ;auf 0 setzten
                      00751         
00D7   1105           00752 L_JoyX_1        BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
00D8   213E           00753         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
00D9   1805           00754         BTFSC   e_DATA          ;e_DATA prüfen
00DA   28E4           00755         GOTO    gLJoyX_write_1  ;empfangenes Bit in Carry-Flag setzen
00DB   28E6           00756         GOTO    gLJoyX_write_0  ;empfangenes Bit in Carry-Flag setzen
00DC                  00757 L_JoyX_2        
Message[305]: Using default destination of 1 (file).
00DC   0DAA           00758         RLF     gLJoyX          ;empfangenes Bit in Register hinzufügen
00DD   1505           00759         BSF     a_CLOCK
00DE   213E           00760         CALL    UP_wait_25us
Message[305]: Using default destination of 1 (file).
00DF   03A0           00761         DECF    zaehler         ;zaehler -1
00E0   08A0           00762         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
00E1   1903           00763         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
00E2   0008           00764         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Position des linken Joysticks (x-Achse)
00E3   28D7           00765         GOTO    L_JoyX_1                ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00766 ;###################################### 
00E4                  00767 gLJoyX_write_1
00E4   1403           00768         BSF     STATUS,C
00E5   28DC           00769         GOTO    L_JoyX_2
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00770 
00E6                  00771 gLJoyX_write_0
00E6   1003           00772         BCF     STATUS,C
00E7   28DC           00773         GOTO    L_JoyX_2
                      00774 ;###############################################################################
                      00775 ;###############################################################################
00E8                  00776 UP_Get_L_Joy_Y  
                      00777         ;H'00' (Bitfolge 00000000) muss im LSB-Verfahren über 
                      00778         ;a_COMMAND gesendet werden.
                      00779         ;IDLE-Modus
                      00780         
00E8   3008           00781         MOVLW   D'8'            ;Anzahl der Bits die pro Befehl gesendet bzw
00E9   00A0           00782         MOVWF   zaehler         ;empfangen werden sollen
00EA   1085           00783         BCF     a_COMMAND       ;auf 0 setzten
                      00784         
00EB   1105           00785 L_JoyY_1        BCF     a_CLOCK         ;negative Flanke (Controller ließt a_COMMAND)...
00EC   213E           00786         CALL    UP_wait_25us    ;aber erst nach 4µs !!!
00ED   1805           00787         BTFSC   e_DATA          ;e_DATA prüfen
00EE   28F8           00788         GOTO    gLJoyY_write_1  ;empfangenes Bit in Carry-Flag setzen
00EF   28FA           00789         GOTO    gLJoyY_write_0  ;empfangenes Bit in Carry-Flag setzen
00F0                  00790 L_JoyY_2        
Message[305]: Using default destination of 1 (file).
00F0   0DAB           00791         RLF     gLJoyY          ;empfangenes Bit in Register hinzufügen
00F1   1505           00792         BSF     a_CLOCK
00F2   213E           00793         CALL    UP_wait_25us
Message[305]: Using default destination of 1 (file).
00F3   03A0           00794         DECF    zaehler         ;zaehler -1
00F4   08A0           00795         MOVF    zaehler,F               ;zaehler ins Arbeitsregister...
00F5   1903           00796         BTFSC   STATUS,Z                ;um zaehler auf 0 zu Prüfen
00F6   0008           00797         RETURN                  ;(STATUS,Z=1)-> zaehler =0 Position des linken Joysticks (y-Achse)
00F7   28EB           00798         GOTO    L_JoyY_1                ;(STATUS,Z=0)-> zaehler >0 nächstes Bit senden
                      00799 ;###################################### 
00F8                  00800 gLJoyY_write_1
00F8   1403           00801         BSF     STATUS,C
00F9   28F0           00802         GOTO    L_JoyY_2
                      00803 
00FA                  00804 gLJoyY_write_0
00FA   1003           00805         BCF     STATUS,C
00FB   28F0           00806         GOTO    L_JoyY_2
                      00807 
                      00808 ;###############################################################################
00FC                  00809 UP_Show_btns
                      00810 ;Ausgabe der Register in denen der Status und die einzelnen Zustände der Buttons stehen 
                      00811  
                      00812 
00FC   0186           00813         CLRF    PORTB       
00FD   0827           00814         MOVFW   gRIGHT          ;Rechte BTNS Register
00FE   0086           00815         MOVWF   PORTB           ;an PORTB anzeigen
                      00816          
                      00817 ;       CLRF    PORTB       
                      00818 ;       MOVFW   gRJoyX          ;RJoyX Register
                      00819 ;       MOVWF   PORTB           ;an PORTB anzeigen
                      00820 ;       CALL    UP_wait_05s
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00821 ;##################
                      00822          
                      00823 ;       CLRF    PORTB
                      00824 ;       MOVFW   gRJoyY          ;RJoyY Register 
                      00825 ;       MOVWF   PORTB           ;an PORTB anzeigen
                      00826 ;       CALL    UP_wait_05s
                      00827 ;##################
                      00828          
                      00829 ;       CLRF    PORTB
                      00830 ;       MOVFW   gLJoyX          ;LJoyX Register
                      00831 ;       MOVWF   PORTB           ;an PORTB anzeigen
                      00832 ;       CALL    UP_wait_05s
                      00833 ;##################
                      00834          
                      00835 ;       CLRF    PORTB
                      00836 ;       MOVFW   gLJoyY          ;LJoyY Register
                      00837 ;       MOVWF   PORTB           ;an PORTB anzeigen
                      00838 ;       CALL    UP_wait_05s
                      00839          
Warning[203]: Found opcode in column 1. (RETURN)
00FF   0008           00840 RETURN
                      00841 ;###############################################################################
0100                  00842 UP_MAX
                      00843 
                      00844 ;kTYPE_adr      EQU     B'00000001' ; Type - Digit-Adresse
                      00845 ;kSTATUS_adr    EQU     B'00000010' ; Status - Digit-Adresse
                      00846 
                      00847 ;kLEFT_adr      EQU     B'00000011' ; LINKS - Digit-Adresse
                      00848 ;kRIGHT_adr     EQU     B'00000100' ; RECHTS - Digit-Adresse
                      00849 
                      00850 ;kRJoyX_adr     EQU     B'00000101' ; Joystick rechts x-Achse - Digit-Adresse
                      00851 ;kRJoyY_adr     EQU     B'00000110' ; Joystick rechts y-Achse - Digit-Adresse
                      00852 
                      00853 ;kLJoyX_adr     EQU     B'00000111' ; Joystick links x-Achse - Digit-Adresse
                      00854 ;kLJoyY_adr     EQU     B'00001000' ; Joystick links y-Achse - Digit-Adresse 
                      00855          
                      00856         
0100   210C           00857         CALL    UP_MAX_init     ;Initialisierung des MAX-Bausteins
                      00858         
                      00859         
                      00860 ;###################################
0101   3001           00861         MOVLW   kTYPE_adr       ; Digit Adresse senden
                      00862         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00863         ;CALL   UP_wait_05s     ;-------DEBUGGING--------
0102   2127           00864          CALL   UP_MAX_send     ;  
                      00865         ;-
                      00866         ;MOVF   gTYPE,W         ;
0103   0826           00867          MOVF   gLEFT,W         ;
                      00868          ;MOVWF PORTB           ;-------DEBUGGING--------
                      00869          ;CALL  UP_wait_05s     ;-------DEBUGGING--------
0104   2127           00870          CALL   UP_MAX_send     ;
                      00871         
0105   1506           00872         BSF     a_MAX_LOAD
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00873         
                      00874          ;CALL  UP_wait_05s
                      00875 ;###################################
0106   3002           00876         MOVLW   kSTATUS_adr     ; Digit Adresse senden
                      00877         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00878         ;CALL   UP_wait_05s     ;-------DEBUGGING--------
0107   2127           00879          CALL   UP_MAX_send     ; 
                      00880          ;-
                      00881          ;MOVF  gSTATUS,W       ;
0108   0827           00882          MOVF   gRIGHT,W                ; 
                      00883          ;MOVWF PORTB           ;-------DEBUGGING--------
                      00884          ;CALL  UP_wait_05s     ;-------DEBUGGING--------
0109   2127           00885          CALL   UP_MAX_send     ;
                      00886          
010A   1506           00887          BSF    a_MAX_LOAD
                      00888          
                      00889          ;CALL  UP_wait_05s
                      00890 ;###################################
                      00891 ;         MOVF  gLEFT,W         ;lade und ...
                      00892 ;         CALL  UP_MAX_send     ;sende 1. 8 Bits
                      00893          ;-
                      00894 ;       MOVF    kLEFT_adr,W     ;lade und ...
                      00895 ;       CALL    UP_MAX_send     ;sende 2. 8 Bits (Auswahl des Anzeige-Digits)
                      00896 ;###################################
                      00897 ;         MOVF  gRIGHT,W                ;lade und ...
                      00898 ;         CALL  UP_MAX_send     ;sende 1. 8 Bits
                      00899          ;-
                      00900 ;       MOVF    kRIGHT_adr,W    ;lade und ...
                      00901 ;         CALL  UP_MAX_send     ;sende 2. 8 Bits (Auswahl des Anzeige-Digits)
                      00902 ;###################################
                      00903 ;       MOVF    gRJoyX,W                ;lade und ...
                      00904 ;       CALL    UP_MAX_send     ;sende 1. 8 Bits
                      00905         ;-
                      00906 ;       MOVF    kRJoyX_adr,W    ;lade und ...
                      00907 ;       CALL    UP_MAX_send     ;sende 2. 8 Bits (Auswahl des Anzeige-Digits)
                      00908 ;###################################
                      00909 ;       MOVF    gRJoyY,W                ;lade und ...
                      00910 ;       CALL    UP_MAX_send     ;sende 1. 8 Bits
                      00911         ;-
                      00912 ;       MOVF    kRJoyY_adr,W    ;lade und ...
                      00913 ;       CALL    UP_MAX_send     ;sende 2. 8 Bits (Auswahl des Anzeige-Digits)
                      00914 ;###################################
                      00915 ;       MOVF    gLJoyX,W                ;lade und ...
                      00916 ;       CALL    UP_MAX_send     ;sende 1. 8 Bits
                      00917         ;-
                      00918 ;       MOVF    kLJoyX_adr,W    ;lade und ...
                      00919 ;       CALL    UP_MAX_send     ;sende 2. 8 Bits (Auswahl des Anzeige-Digits)
                      00920 ;###################################
                      00921 ;       MOVF    gLJoyY,W                ;lade und ...
                      00922 ;       CALL    UP_MAX_send     ;sende 1. 8 Bits
                      00923         ;-
                      00924 ;       MOVF    kLJoyY_adr,W    ;lade und ...
                      00925 ;       CALL    UP_MAX_send     ;sende 2. 8 Bits (Auswahl des Anzeige-Digits)
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00926         
Warning[203]: Found opcode in column 1. (RETURN)
010B   0008           00927 RETURN
                      00928 ;#####################################
010C                  00929 UP_MAX_init
                      00930 
                      00931 ;MAX Digit Kodierungs
                      00932 ;kMODUS_adr     EQU     B'00001001' ; 0x09 Modusbefehlsadresse
                      00933 ;m_MODUS                EQU     B'00000000' ; 0x00 MAX Digit Kodierungsmodus            ->keine Kodierun
                            g<-
                      00934 
                      00935 ;kD_MODUS_adr   EQU     B'00001001' ; 0x09 Digit Kodierungsmodus Adresse
                      00936 ;m_D_MODUS      EQU     B'00000000' ; 0x00 MAX Digit Kodierungsmodus            ->keine Kodierung<-
                      00937 
                      00938 ;MAX Digit Helligkeit
                      00939 ;kHELLIGKEIT_adr        EQU     B'00001010' ; 0x0A MAX Helligkeitssteuerung Adresse
                      00940 ;m_HELLIGKEIT   EQU     B'00001111' ; 0x15 MAX Helligkeitssteuerung             ->Digit 31 / 32 (max ON)
                            <-
                      00941 
                      00942 ;MAX Digit Anzahl
                      00943 ;kDIGITS_adr    EQU     B'00001011' ; 0x0B Digitsanzahl Adresse
                      00944 ;m_DIGITS       EQU     B'00000001' ; 0x01 Anzahl der aktivierten Digits        ->Digit 0 und 1<-
                      00945 
                      00946 ;MAX Shutdown
                      00947 ;kSTART_adr     EQU     B'00001100' ; 0x0C Startbefehlsadresse
                      00948 ;m_START                EQU     B'00000001' ; 0x01 MAX Shutdownbefehl           ->Normal Operation<-
                      00949 
                      00950 ;kSHUTDOWN_adr  EQU     B'00001100' ; 0x0C SHUTDOWN Adresse
                      00951 ;m_SHUTDOWN     EQU     B'00000001' ; 0x01 MAX Shutdownbefehl           ->Normal Operation<-
                      00952 
                      00953 ;MAX Test
                      00954 ;kTEST_adr      EQU     B'00001111' ; 0x0F Testbefehlsadresse
                      00955 ;m_TEST         EQU     B'00000000' ; 0x00 MAX Testmodus                        ->KEIN TESTMODUS<-
                      00956 
                      00957 
010C   1506           00958          BSF    a_MAX_LOAD      ; Falls es noch auf LOW steht.. wird es jetz HIGH 
                      00959         
                      00960          ;###########################   Anzahl der genutzten Digits senden
010D   300B           00961         MOVLW   kDIGITS_adr     ; erst Adresse
                      00962         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00963         ;CALL   UP_wait_05s     ;-------DEBUGGING--------               
010E   2127           00964         CALL    UP_MAX_send     ;       0x0B
                      00965         ;#########               ;
010F   3001           00966         MOVLW   m_DIGITS                ; dann die Anzahl der Digits
                      00967         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00968         ;CALL   UP_wait_05s     ;-------DEBUGGING--------               
0110   2127           00969         CALL    UP_MAX_send     ;       0x01 (2 Digits)
                      00970         
0111   1506           00971         BSF     a_MAX_LOAD      ; Nach 2 Byte (1 word) muss LOAD auf HIGH
                      00972         
                      00973         ;###########################    Shutdownmodus senden    
                      00974                                 ; 
0112   300C           00975         MOVLW   kSHUTDOWN_adr   ; erst Adresse
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00976         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00977         ;CALL   UP_wait_05s     ;-------DEBUGGING--------
0113   2127           00978          CALL   UP_MAX_send     ;       0x0C
                      00979          ;#########             ; dann der Befehl selbst senden
0114   3001           00980         MOVLW   m_SHUTDOWN      ;       0x01 (Normal Operation)
                      00981         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00982         ;CALL   UP_wait_05s     ;-------DEBUGGING--------
0115   2127           00983          CALL   UP_MAX_send     ;
                      00984          
0116   1506           00985         BSF     a_MAX_LOAD      ; Nach 2 Byte (1 word) muss LOAD auf HIGH
                      00986         
                      00987         ;###########################    Testmodus senden        
                      00988                                 ; 
0117   300F           00989         MOVLW   kTEST_adr       ; erst Adresse
                      00990         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00991         ;CALL   UP_wait_05s     ;-------DEBUGGING--------
0118   2127           00992          CALL   UP_MAX_send     ;       0x0C
                      00993          ;#########             ; dann der Befehl selbst senden
0119   3000           00994         MOVLW   m_TEST          ;       0x01 (Normal Operation)
                      00995         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      00996         ;CALL   UP_wait_05s     ;-------DEBUGGING--------
011A   2127           00997          CALL   UP_MAX_send     ;
                      00998          
011B   1506           00999         BSF     a_MAX_LOAD      ; Nach 2 Byte (1 word) muss LOAD auf HIGH
                      01000         
                      01001          ;###########################   Digit Kodierungsmodus senden
011C   3009           01002         MOVLW   kMODUS_adr      ; erst Adresse
                      01003         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      01004         ;CALL   UP_wait_05s     ;-------DEBUGGING--------       
011D   2127           01005          CALL   UP_MAX_send     ;       0x09 
                      01006          ;#########             ; dann der Befehl selbst
011E   3000           01007          MOVLW  m_MODUS         ;       0x00 (keine Kodierung der Digits)
                      01008          ;MOVWF PORTB           ;-------DEBUGGING--------
                      01009          ;CALL  UP_wait_05s     ;-------DEBUGGING--------
011F   2127           01010          CALL   UP_MAX_send     ;
                      01011          
0120   1506           01012          BSF    a_MAX_LOAD      ; Nach 2 Byte (1 word) muss LOAD auf HIGH
                      01013          
                      01014          ;###########################   Helligkeitseinstellung senden
0121   300A           01015         MOVLW   kHELLIGKEIT_adr ; erst Adresse
                      01016         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      01017         ;CALL   UP_wait_05s     ;-------DEBUGGING--------
0122   2127           01018          CALL   UP_MAX_send     ;       0x0A
                      01019          ;#########             ; dann die Helligkeitseinstellung selbst
0123   300F           01020          MOVLW  m_HELLIGKEIT    ;       0x15 (31/32 an)
                      01021         ;MOVWF  PORTB           ;-------DEBUGGING--------
                      01022         ;CALL   UP_wait_05s     ;-------DEBUGGING--------               
0124   2127           01023          CALL   UP_MAX_send     ; 
                      01024          
0125   1506           01025          BSF    a_MAX_LOAD      ; Nach 2 Byte (1 word) muss LOAD auf HIGH
                      01026 
                      01027 
                      01028         
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[203]: Found opcode in column 1. (RETURN)
0126   0008           01029 RETURN
                      01030          
                      01031 ;#####################################
0127                  01032 UP_MAX_send
0127   00AC           01033         MOVWF   sMAX
0128   3008           01034         MOVLW   D'8'
0129   00A0           01035         MOVWF   zaehler
012A   1106           01036         BCF     a_MAX_LOAD      ;Vor der Übertragung von 2 Bytes auf LOW
                      01037         
Message[305]: Using default destination of 1 (file).
012B   0DAC           01038 MAX_s1  RLF     sMAX            ;MSB zuerst...
012C   1803           01039         BTFSC   STATUS,C
012D   2937           01040         GOTO    MAX_send_1      ;MAX-Datenleitung auf HIGH      (Übertrage 1)
012E   1006           01041         BCF     a_MAX_DATA      ;MAX-Datenleitung auf LOW       (Übertrage 0)   
                      01042         
012F   1086           01043 MAX_s2  BCF     a_MAX_CLOCK     ;
                      01044         ;CALL   UP_wait_05s     ; #############DEBUGGING#############
0130   1486           01045         BSF     a_MAX_CLOCK     ;Positive Flanke erzeugen
0131   1086           01046         BCF     a_MAX_CLOCK
                      01047         
Message[305]: Using default destination of 1 (file).
0132   03A0           01048         DECF    zaehler
0133   08A0           01049         MOVF    zaehler,F       ; Zähler ...
0134   1D03           01050         BTFSS   STATUS,Z                ; ... auf 0 prüfen,
0135   292B           01051         GOTO    MAX_s1          ; <-- Zähler != 0
                      01052                                         ; <-- Zähler == 0 (Schleifenende)
                      01053         ;BSF    a_MAX_LOAD      ;NACH der Übertragung von 2 Bytes auf LOW
                      01054         
                      01055                                 ;geht hier noch nicht, da ich nur ein Byte
                      01056                                 ;über das UP_MAX_send übertrage!!!!
0136   0008           01057         RETURN
                      01058         
0137                  01059 MAX_send_1
0137   1406           01060         BSF     a_MAX_DATA
0138   292F           01061         GOTO    MAX_s2
                      01062         
                      01063 ;###############################################################################
                      01064 ;###########################      Warteschleifen     ###########################
                      01065 ;###############################################################################
                      01066 
                      01067 ;############################***********************############################
                      01068 ;##########################  ATTENTION Warteschleife  ##########################
                      01069 ;UP_wait_20us
                      01070 ;                       ;100 cycles
                      01071 ;       movlw   0x21
                      01072 ;       movwf   wait_20us
                      01073 ;loop20us_0
                      01074 ;       decfsz  wait_20us, f
                      01075 ;       goto    loop20us_0
                      01076 ;RETURN
                      01077 ;##########################  ATTENTION Warteschleife 2 #########################
0139                  01078 UP_wait_50us
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01079                         ;250 cycles
0139   3053           01080         movlw   0x53
013A   00AF           01081         movwf   wait_50us
013B                  01082 loop50us_0
013B   0BAF           01083         decfsz  wait_50us, f
013C   293B           01084         goto    loop50us_0
Warning[203]: Found opcode in column 1. (RETURN)
013D   0008           01085 RETURN
                      01086 ;########################**********************************#####################
                      01087 ;###################### CLOCK LOW - CLOCK HIGH Warteschleife ###################
                      01088 ;UP_wait_5us            ;UP_wait_5us
                      01089 ;                       ;25 cycles
                      01090 ;       movlw   0x08
                      01091 ;       movwf   wait_5us
                      01092 ;loop5us_0
                      01093 ;       decfsz  wait_5us, f
                      01094 ;       goto    loop5us_0
                      01095 ;RETURN
                      01096 ;##################### CLOCK LOW - CLOCK HIGH Warteschleife 2 ##################
013E                  01097 UP_wait_25us            ;UP_wait_5us
                      01098                         ;124 cycles
013E   3029           01099         movlw   0x29
013F   00B0           01100         movwf   wait_25us
0140                  01101 loop25us_0
0140   0BB0           01102         decfsz  wait_25us, f
0141   2940           01103         goto    loop25us_0
                      01104 
                      01105                         ;1 cycle
0142   0000           01106         nop
Warning[203]: Found opcode in column 1. (RETURN)
0143   0008           01107 RETURN
                      01108 ;############################***********************############################
                      01109 ;############################ Ausgabe Warteschleife ############################
0144                  01110 UP_wait_05s
                      01111                         ;2499999 cycles
0144   3016           01112         movlw   0x16
0145   00B1           01113         movwf   wait_05s
0146   3074           01114         movlw   0x74
0147   00B2           01115         movwf   wait_05s_1
0148   3006           01116         movlw   0x06
0149   00B3           01117         movwf   wait_05s_2
014A                  01118 loop05s_0
014A   0BB1           01119         decfsz  wait_05s, f
014B   294D           01120         goto    $+2
014C   0BB2           01121         decfsz  wait_05s_1, f
014D   294F           01122         goto    $+2
014E   0BB3           01123         decfsz  wait_05s_2, f
014F   294A           01124         goto    loop05s_0
                      01125 
                      01126                         ;1 cycle
0150   0000           01127         nop
Warning[203]: Found opcode in column 1. (RETURN)
0151   0008           01128 RETURN
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01129 
                      01130 
                      01131 
                      01132 ;###############################################################################
                      01133 ;
                      01134 ;       geht auch mit dyn. Tabelle!!!
                      01135 ;       zaehler HOCHZÄHLEN lassen, in Tabelle springen (Übertragungsbyte)
                      01136 ;       laden und dann zaehler auf Anzahl der Übertragungsbytes prüfen,
                      01137 ;       zaehler<Anzahl der Übertragungsbytes -> nächste Tabellenzeile übertragen
                      01138 ;       zaehler=Anzahl der Übertragungsbytes -> RETURN
                      01139 ;
                      01140 ;tab_MAX                                ; MAXIMAL bis 21 zaehlen!!!!
                      01141 ;       ORG     0x300           ; Tabelle in Speicherblock 3
                      01142 
                      01143 ;       RETLW   kSTART          ; Start-Befehl
                      01144 ;       RETLW   kSTART_adr      ; Startbefehlsadresse
                      01145 
                      01146 ;       RETLW   kMODUS          ; Modus-Befehl
                      01147 ;       RETLW   kMODUS_adr      ; Modusbefehlsadresse
                      01148  
                      01149 ;       RETLW   gTYPE           ; Controller Type
                      01150 ;       RETLW   kTYPE_adr       ; Type - Digit-Adresse
                      01151 
                      01152 ;       RETLW   gSTATUS         ; Controller Status
                      01153 ;       RETLW   kSTATUS_adr     ; Status - Digit-Adresse
                      01154 
                      01155 ;       RETLW   gLEFT           ; Buttons LINKS
                      01156 ;       RETLW   kLEFT_adr       ; LINKS - Digit-Adresse
                      01157 
                      01158 ;       RETLW   gRIGHT          ; Buttons RECHTS
                      01159 ;       RETLW   kRIGHT_adr      ; RECHTS - Digit-Adresse
                      01160 
                      01161 ;       RETLW   gRJoyX          ; Joystick rechts x-Achse
                      01162 ;       RETLW   kRJoyX_adr      ; Joystick rechts x-Achse - Digit-Adresse
                      01163 
                      01164 ;       RETLW   gRJoyY          ; Joystick rechts y-Achse
                      01165 ;       RETLW   kRJoyY_adr      ; Joystick rechts y-Achse - Digit-Adresse
                      01166 
                      01167 ;       RETLW   gLJoyX          ; Joystick links  x-Achse
                      01168 ;       RETLW   kLJoyX_adr      ; Joystick links x-Achse - Digit-Adresse
                      01169 
                      01170 ;       RETLW   gLJoyY          ; Joystick links        y-Achse
                      01171 ;       RETLW   kLJoyY_adr      ; Joystick links y-Achse - Digit-Adresse
                      01172 ;
                      01173 ; mit DT lässt sich eine Wertetabelle aufbauen. Dabei steht jeder Wert für die Anweisung
                      01174 ; 'RETLW <wert>'. Die Tabelle lässt sich also alternativ auch mit einer Liste von 'RETLW'-
                      01175 ; Anweisungen aufbauen.
                      01176 
Warning[205]: Found directive in column 1. (END)
                      01177 END
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

C                                 00000000
DC                                00000001
EEADR                             00000009
EECON1                            00000088
EECON2                            00000089
EEDATA                            00000008
EEIE                              00000006
EEIF                              00000004
F                                 00000001
FSR                               00000004
GIE                               00000007
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
L_JoyX_1                          000000D7
L_JoyX_2                          000000DC
L_JoyY_1                          000000EB
L_JoyY_2                          000000F0
L_btns_1                          00000087
L_btns_2                          0000008C
MAX_s1                            0000012B
MAX_s2                            0000012F
MAX_send_1                        00000137
NOT_PD                            00000003
NOT_RBPU                          00000007
NOT_TO                            00000004
OPTION_REG                        00000081
PCL                               00000002
PCLATH                            0000000A
PORTA                             00000005
PORTB                             00000006
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
RBIE                              00000003
RBIF                              00000000
RD                                00000000
RP0                               00000005
RP1                               00000006
R_JoyX_1                          000000AF
R_JoyX_2                          000000B4
R_JoyY_1                          000000C3
R_JoyY_2                          000000C8
R_btns_1                          0000009B
R_btns_2                          000000A0
STATUS                            00000003
Start_1                           00000032
Start_2                           00000036
Status_1                          00000073
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 25


SYMBOL TABLE
  LABEL                             VALUE 

Status_2                          00000078
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
TMR0                              00000001
TRISA                             00000085
TRISB                             00000086
Type_1                            0000004B
Type_2                            0000004F
UP_Bit0                           0000003B
UP_Bit0_write_gTYPE               00000054
UP_Bit1                           00000041
UP_Bit1_write_gTYPE               00000062
UP_Get_L_Joy_X                    000000D4
UP_Get_L_Joy_Y                    000000E8
UP_Get_L_btns                     00000084
UP_Get_R_Joy_X                    000000AC
UP_Get_R_Joy_Y                    000000C0
UP_Get_R_btns                     00000098
UP_Get_Status                     00000070
UP_Get_Type                       00000047
UP_MAX                            00000100
UP_MAX_init                       0000010C
UP_MAX_send                       00000127
UP_Show_btns                      000000FC
UP_Start                          0000002E
UP_wait_05s                       00000144
UP_wait_25us                      0000013E
UP_wait_50us                      00000139
W                                 00000000
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_CP_OFF                           00003FFF
_CP_ON                            0000000F
_HS_OSC                           00003FFE
_LP_OSC                           00003FFC
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F84A                          00000001
a1                                PORTB, 0
a2                                PORTB, 4
a_ATT                             PORTA, 3
a_CLOCK                           PORTA, 2
a_COMMAND                         PORTA, 1
a_MAX_CLOCK                       PORTB, 1
a_MAX_DATA                        PORTB, 0
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 26


SYMBOL TABLE
  LABEL                             VALUE 

a_MAX_LOAD                        PORTB, 2
b1                                PORTB, 1
b2                                PORTB, 5
bank1                             STATUS, RP0
c1                                PORTB, 2
c2                                PORTB, 6
d1                                PORTB, 3
d2                                PORTB, 7
e_DATA                            PORTA, 0
gLEFT                             00000026
gLEFT_write_0                     00000096
gLEFT_write_1                     00000094
gLJoyX                            0000002A
gLJoyX_write_0                    000000E6
gLJoyX_write_1                    000000E4
gLJoyY                            0000002B
gLJoyY_write_0                    000000FA
gLJoyY_write_1                    000000F8
gRIGHT                            00000027
gRIGHT_write_0                    000000AA
gRIGHT_write_1                    000000A8
gRJoyX                            00000028
gRJoyX_write_0                    000000BE
gRJoyX_write_1                    000000BC
gRJoyY                            00000029
gRJoyY_write_0                    000000D2
gRJoyY_write_1                    000000D0
gSTATUS                           00000024
gSTATUS_write_0                   00000082
gSTATUS_write_1                   00000080
gTYPE                             00000023
init                              00000001
kDIGITS_adr                       0000000B
kD_MODUS_adr                      00000009
kHELLIGKEIT_adr                   0000000A
kLEFT_adr                         00000003
kLJoyX_adr                        00000007
kLJoyY_adr                        00000008
kMODUS_adr                        00000009
kRIGHT_adr                        00000004
kRJoyX_adr                        00000005
kRJoyY_adr                        00000006
kSHUTDOWN_adr                     0000000C
kSTART_adr                        0000000C
kSTATUS_adr                       00000002
kTEST_adr                         0000000F
kTYPE_adr                         00000001
loop05s_0                         0000014A
loop25us_0                        00000140
loop50us_0                        0000013B
m_DIGITS                          00000001
m_D_MODUS                         00000000
m_HELLIGKEIT                      0000000F
MPASM  5.06                    PROJEKT2_0.ASM   3-30-2007  13:18:23         PAGE 27


SYMBOL TABLE
  LABEL                             VALUE 

m_MODUS                           00000000
m_SHUTDOWN                        00000001
m_START                           00000001
m_TEST                            00000000
main                              0000001A
rSTATUS                           00000025
sMAX                              0000002C
sMAX_B1                           0000002D
sMAX_B2                           0000002E
sSTART                            00000021
sTYPE                             00000022
sTYPE0_next                       0000005A
sTYPE0_write_0                    00000060
sTYPE0_write_1                    0000005E
sTYPE1_next                       00000068
sTYPE1_write_0                    0000006E
sTYPE1_write_1                    0000006C
wait_05s                          00000031
wait_05s_1                        00000032
wait_05s_2                        00000033
wait_25us                         00000030
wait_50us                         0000002F
zaehler                           00000020


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XX-------------- ---------------- ----------------
2000 : -------X-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:   338
Program Memory Words Free:   686


Errors   :     0
Warnings :     8 reported,     0 suppressed
Messages :    24 reported,     0 suppressed

Error[173]  : Source file path exceeds 62 characters (C:\DOKUMENTE UND EINSTELLUNGEN\KITE\DESKTOP\PROJEKTE\ATINF\PROJEKT\ASSEMBLER\M
                            PLAB\PROJEKT2_0.ASM)
